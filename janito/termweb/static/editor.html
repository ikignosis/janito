<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" type="image/svg+xml" href="/static/termicon.svg">
    <link rel="shortcut icon" type="image/x-icon" href="/static/favicon.ico">
    <meta charset="UTF-8">
    <title>TermWeb Dual Pane Editor &mdash; janito.dev</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.css">
    <link rel="stylesheet" href="/static/termweb.css">
</head>
<body>
    <div class="header">
        TermWeb Dual Pane Editor
    </div>
    <div class="main">
        <div class="editor-pane">
            <div class="pane-header">
                <span>Editor (CodeMirror)<span class="filename-label" id="filename-label"></span></span>
            </div>
            <textarea id="code" name="code"># Welcome to TermWeb!
# This is a live CodeMirror editor.
# Use the toggle button to show/hide the preview panel.

print("Hello, janito.dev!")
</textarea>
        </div>
        <div class="preview-pane" id="preview-pane">
            <div class="pane-header">
                <span>Preview</span>
                <button class="toggle-btn" id="toggle-preview">Hide Preview</button>
            </div>
            <pre id="preview-content"></pre>
        </div>
    </div>
    <div class="footer">
        <div class="subtitle">
            Powered by <a href="https://janito.dev" target="_blank">janito.dev</a> &mdash; AI-powered coding agent
        </div>
        <ul>
            <li>🌐 <a href="https://janito.dev" target="_blank">janito.dev</a></li>
            <li>📚 <a href="https://docs.janito.dev" target="_blank">Documentation</a></li>
            <li>💻 <a href="https://github.com/joaompinto/janito" target="_blank">GitHub</a></li>
        </ul>
        <span style="font-size:0.9em;opacity:0.7;">_generated by janito.dev_</span>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/python/python.min.js"></script>
    <script src="/static/termweb.js"></script>
    <script>
    // --- Load file content via AJAX if ?path=... is present ---
    function getQueryParam(name) {
        const url = new URL(window.location.href);
        return url.searchParams.get(name);
    }
    const filePath = getQueryParam('path');
    if (filePath) {
        fetch(`/api/explorer/${encodeURIComponent(filePath)}`)
            .then(resp => resp.json())
            .then(data => {
                if (data.type === 'file') {
                    document.getElementById('code').value = data.content;
                    document.getElementById('filename-label').textContent = ' [' + data.path + ']';
                } else if (data.error) {
                    document.getElementById('code').value = '# Error: ' + data.error;
                }
            })
            .catch(err => {
                document.getElementById('code').value = '# Error loading file: ' + err;
            });
    }
    </script>
</body>
</html>
